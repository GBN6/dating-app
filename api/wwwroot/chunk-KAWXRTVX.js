import{a as xe}from"./chunk-YRYVOI5Y.js";import{a as H}from"./chunk-U6QSPUA6.js";import{a as Te}from"./chunk-MWMNPXYR.js";import{a as Ie,c as Ae,e as Ue,h as ke,j as qe}from"./chunk-PD4XELQA.js";import{a as et,b as tt}from"./chunk-XICTCNVT.js";import{a as ge,b as Pe,c as Oe,d as De}from"./chunk-HHNKQW6O.js";import"./chunk-FEM247ZK.js";import{c as z}from"./chunk-4GYA7ECF.js";import{a as Xe,b as Ze,c as Ye,d as Ke}from"./chunk-YR5YZ3DP.js";import{a as be}from"./chunk-DE7X7RVW.js";import"./chunk-DEM2V6YX.js";import"./chunk-SLUF46T5.js";import{b as Re,c as He,d as Ne,e as Le,f as Ve,g as je,h as $e,i as Qe,j as Ge,k as We,m as Je}from"./chunk-XVLLIRVL.js";import{a as ze,b as Be}from"./chunk-P2CIGLQN.js";import{a as Ce,b as _,d as B,e as ye,g as Me,h as Se,i as Fe,j as we,n as Ee,p as R}from"./chunk-Y3WRGRHF.js";import{ba as ve}from"./chunk-OQHUP3JO.js";import{a as q}from"./chunk-QCTHIZDT.js";import{$ as g,$a as ae,Ab as p,Bb as v,Cb as G,Db as pe,Ea as U,Ga as l,Ib as de,Ka as ie,Lb as w,Mb as W,Nb as k,Oa as F,Pa as oe,Qa as ne,Rb as me,Sa as re,T as S,Ua as u,Y as K,Za as m,a as y,ac as ce,cb as M,eb as se,fb as le,ga as x,gb as a,ha as C,hb as s,ib as c,ic as ue,jb as $,ka as ee,kb as Q,kc as he,lc as fe,mb as O,mc as _e,oa as A,ob as f,pb as h,ra as P,sa as te,t as Y,ua as j}from"./chunk-U7UGUVDU.js";var N=class n extends De{placeholder=P("");rows=P(5);static \u0275fac=(()=>{let e;return function(i){return(e||(e=ee(n)))(i||n)}})();static \u0275cmp=F({type:n,selectors:[["app-field-textarea"]],inputs:{placeholder:[1,"placeholder"],rows:[1,"rows"]},features:[re],decls:4,vars:6,consts:[[1,"field"],[1,"field__label",3,"for"],["type","textarea",1,"field__input",3,"rows","id","placeholder","formControl"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"label",1),p(2),s(),c(3,"textarea",2),s()),t&2&&(l(),m("for",i.id),l(),v(i.label()),l(),m("rows",i.rows())("id",i.id)("placeholder",i.placeholder())("formControl",i.formControl))},dependencies:[R,Ce,B,Se,Oe],encapsulation:2,changeDetection:0})};var D=class{constructor(e){this.rawFile=e;let t=e instanceof HTMLInputElement?e.value:e;this[`_createFrom${typeof t=="string"?"FakePath":"Object"}`](t)}_createFromFakePath(e){this.lastModifiedDate=void 0,this.size=void 0,this.type=`like/${e.slice(e.lastIndexOf(".")+1).toLowerCase()}`,this.name=e.slice(e.lastIndexOf("/")+e.lastIndexOf("\\")+2)}_createFromObject(e){this.size=e.size,this.type=e.type,this.name=e.name}},X=class{constructor(e,t,i){this.url="/",this.headers=[],this.withCredentials=!0,this.formData=[],this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.uploader=e,this.some=t,this.options=i,this.file=new D(t),this._file=t,e.options&&(this.method=e.options.method||"POST",this.alias=e.options.itemAlias||"file"),this.url=e.options.url}upload(){try{this.uploader.uploadItem(this)}catch{this.uploader._onCompleteItem(this,"",0,{}),this.uploader._onErrorItem(this,"",0,{})}}cancel(){this.uploader.cancelItem(this)}remove(){this.uploader.removeFromQueue(this)}onBeforeUpload(){}onBuildForm(e){return{form:e}}onProgress(e){return{progress:e}}onSuccess(e,t,i){return{response:e,status:t,headers:i}}onError(e,t,i){return{response:e,status:t,headers:i}}onCancel(e,t,i){return{response:e,status:t,headers:i}}onComplete(e,t,i){return{response:e,status:t,headers:i}}_onBeforeUpload(){this.isReady=!0,this.isUploading=!0,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()}_onBuildForm(e){this.onBuildForm(e)}_onProgress(e){this.progress=e,this.onProgress(e)}_onSuccess(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=void 0,this.onSuccess(e,t,i)}_onError(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=void 0,this.onError(e,t,i)}_onCancel(e,t,i){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=void 0,this.onCancel(e,t,i)}_onComplete(e,t,i){this.onComplete(e,t,i),this.uploader.options.removeAfterUpload&&this.remove()}_prepareToUploading(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0}},lt=(()=>{class n{static{this.mime_doc=["application/msword","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"]}static{this.mime_xsl=["application/vnd.ms-excel","application/vnd.ms-excel","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12"]}static{this.mime_ppt=["application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"]}static{this.mime_psd=["image/photoshop","image/x-photoshop","image/psd","application/photoshop","application/psd","zz-application/zz-winassoc-psd"]}static{this.mime_compress=["application/x-gtar","application/x-gcompress","application/compress","application/x-tar","application/x-rar-compressed","application/octet-stream","application/x-zip-compressed","application/zip-compressed","application/x-7z-compressed","application/gzip","application/x-bzip2"]}static getMimeClass(t){let i="application";return t?.type&&this.mime_psd.indexOf(t.type)!==-1||t?.type?.match("image.*")?i="image":t?.type?.match("video.*")?i="video":t?.type?.match("audio.*")?i="audio":t?.type==="application/pdf"?i="pdf":t?.type&&this.mime_compress.indexOf(t.type)!==-1?i="compress":t?.type&&this.mime_doc.indexOf(t.type)!==-1?i="doc":t?.type&&this.mime_xsl.indexOf(t.type)!==-1?i="xls":t?.type&&this.mime_ppt.indexOf(t.type)!==-1&&(i="ppt"),i==="application"&&t?.name&&(i=this.fileTypeDetection(t.name)),i}static fileTypeDetection(t){let i={jpg:"image",jpeg:"image",tif:"image",psd:"image",bmp:"image",png:"image",nef:"image",tiff:"image",cr2:"image",dwg:"image",cdr:"image",ai:"image",indd:"image",pin:"image",cdp:"image",skp:"image",stp:"image","3dm":"image",mp3:"audio",wav:"audio",wma:"audio",mod:"audio",m4a:"audio",compress:"compress",zip:"compress",rar:"compress","7z":"compress",lz:"compress",z01:"compress",bz2:"compress",gz:"compress",pdf:"pdf",xls:"xls",xlsx:"xls",ods:"xls",mp4:"video",avi:"video",wmv:"video",mpg:"video",mts:"video",flv:"video","3gp":"video",vob:"video",m4v:"video",mpeg:"video",m2ts:"video",mov:"video",doc:"doc",docx:"doc",eps:"doc",txt:"doc",odt:"doc",rtf:"doc",ppt:"ppt",pptx:"ppt",pps:"ppt",ppsx:"ppt",odp:"ppt"},o=t.split(".");if(o.length<2)return"application";let r=o[o.length-1].toLowerCase();return i[r]===void 0?"application":i[r]}}return n})();function pt(n){return File&&n instanceof File}var L=class{constructor(e){this.isUploading=!1,this.queue=[],this.progress=0,this._nextIndex=0,this.options={autoUpload:!1,isHTML5:!0,filters:[],removeAfterUpload:!1,disableMultipart:!1,formatDataFunction:t=>t._file,formatDataFunctionIsAsync:!1,url:""},this.setOptions(e),this.response=new A}setOptions(e){this.options=Object.assign(this.options,e),this.authToken=this.options.authToken,this.authTokenHeader=this.options.authTokenHeader||"Authorization",this.autoUpload=this.options.autoUpload,this.options.filters?.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.options.maxFileSize&&this.options.filters?.unshift({name:"fileSize",fn:this._fileSizeFilter}),this.options.allowedFileType&&this.options.filters?.unshift({name:"fileType",fn:this._fileTypeFilter}),this.options.allowedMimeType&&this.options.filters?.unshift({name:"mimeType",fn:this._mimeTypeFilter});for(let t=0;t<this.queue.length;t++)this.queue[t].url=this.options.url}addToQueue(e,t,i){let o=t,r=[];for(let I of e)r.push(I);let d=this._getFilters(i),b=this.queue.length,T=[];r.map(I=>{o||(o=this.options);let Z=new D(I);if(this._isValidFile(Z,d,o)){let E=new X(this,I,o);T.push(E),this.queue.push(E),this._onAfterAddingFile(E)}else if(typeof this._failFilterIndex=="number"&&this._failFilterIndex>=0){let E=d[this._failFilterIndex];this._onWhenAddingFileFailed(Z,E,o)}}),this.queue.length!==b&&(this._onAfterAddingAll(T),this.progress=this._getTotalProgress()),this._render(),this.options.autoUpload&&this.uploadAll()}removeFromQueue(e){let t=this.getIndexOfItem(e),i=this.queue[t];i.isUploading&&i.cancel(),this.queue.splice(t,1),this.progress=this._getTotalProgress()}clearQueue(){for(;this.queue.length;)this.queue[0].remove();this.progress=0}uploadItem(e){let t=this.getIndexOfItem(e),i=this.queue[t],o=this.options.isHTML5?"_xhrTransport":"_iframeTransport";i._prepareToUploading(),!this.isUploading&&(this.isUploading=!0,this[o](i))}cancelItem(e){let t=this.getIndexOfItem(e),i=this.queue[t],o=this.options.isHTML5?i._xhr:i._form;i&&i.isUploading&&o.abort()}uploadAll(){let e=this.getNotUploadedItems().filter(t=>!t.isUploading);e.length&&(e.map(t=>t._prepareToUploading()),e[0].upload())}cancelAll(){this.getNotUploadedItems().map(t=>t.cancel())}isFile(e){return pt(e)}isFileLikeObject(e){return e instanceof D}getIndexOfItem(e){return typeof e=="number"?e:this.queue.indexOf(e)}getNotUploadedItems(){return this.queue.filter(e=>!e.isUploaded)}getReadyItems(){return this.queue.filter(e=>e.isReady&&!e.isUploading).sort((e,t)=>e.index-t.index)}onAfterAddingAll(e){return{fileItems:e}}onBuildItemForm(e,t){return{fileItem:e,form:t}}onAfterAddingFile(e){return{fileItem:e}}onWhenAddingFileFailed(e,t,i){return{item:e,filter:t,options:i}}onBeforeUploadItem(e){return{fileItem:e}}onProgressItem(e,t){return{fileItem:e,progress:t}}onProgressAll(e){return{progress:e}}onSuccessItem(e,t,i,o){return{item:e,response:t,status:i,headers:o}}onErrorItem(e,t,i,o){return{item:e,response:t,status:i,headers:o}}onCancelItem(e,t,i,o){return{item:e,response:t,status:i,headers:o}}onCompleteItem(e,t,i,o){return{item:e,response:t,status:i,headers:o}}onCompleteAll(){}_mimeTypeFilter(e){return!(e?.type&&this.options.allowedMimeType&&this.options.allowedMimeType?.indexOf(e.type)===-1)}_fileSizeFilter(e){return!(this.options.maxFileSize&&e.size>this.options.maxFileSize)}_fileTypeFilter(e){return!(this.options.allowedFileType&&this.options.allowedFileType.indexOf(lt.getMimeClass(e))===-1)}_onErrorItem(e,t,i,o){e._onError(t,i,o),this.onErrorItem(e,t,i,o)}_onCompleteItem(e,t,i,o){e._onComplete(t,i,o),this.onCompleteItem(e,t,i,o);let r=this.getReadyItems()[0];if(this.isUploading=!1,r){r.upload();return}this.onCompleteAll(),this.progress=this._getTotalProgress(),this._render()}_headersGetter(e){return t=>t?e[t.toLowerCase()]||void 0:e}_xhrTransport(e){let t=this,i=e._xhr=new XMLHttpRequest,o;if(this._onBeforeUploadItem(e),typeof e._file.size!="number")throw new TypeError("The file specified is no longer valid");if(this.options.disableMultipart)this.options.formatDataFunction&&(o=this.options.formatDataFunction(e));else{o=new FormData,this._onBuildItemForm(e,o);let r=()=>o.append(e.alias,e._file,e.file.name);this.options.parametersBeforeFiles||r(),this.options.additionalParameter!==void 0&&Object.keys(this.options.additionalParameter).forEach(d=>{let b=this.options.additionalParameter?.[d];typeof b=="string"&&b.indexOf("{{file_name}}")>=0&&e.file?.name&&(b=b.replace("{{file_name}}",e.file.name)),o.append(d,b)}),r&&this.options.parametersBeforeFiles&&r()}if(i.upload.onprogress=r=>{let d=Math.round(r.lengthComputable?r.loaded*100/r.total:0);this._onProgressItem(e,d)},i.onload=()=>{let r=this._parseHeaders(i.getAllResponseHeaders()),d=this._transformResponse(i.response),T=`_on${this._isSuccessCode(i.status)?"Success":"Error"}Item`;this[T](e,d,i.status,r),this._onCompleteItem(e,d,i.status,r)},i.onerror=()=>{let r=this._parseHeaders(i.getAllResponseHeaders()),d=this._transformResponse(i.response);this._onErrorItem(e,d,i.status,r),this._onCompleteItem(e,d,i.status,r)},i.onabort=()=>{let r=this._parseHeaders(i.getAllResponseHeaders()),d=this._transformResponse(i.response);this._onCancelItem(e,d,i.status,r),this._onCompleteItem(e,d,i.status,r)},e.method&&e.url&&i.open(e.method,e.url,!0),i.withCredentials=e.withCredentials,this.options.headers)for(let r of this.options.headers)i.setRequestHeader(r.name,r.value);if(e.headers.length)for(let r of e.headers)i.setRequestHeader(r.name,r.value);this.authToken&&this.authTokenHeader&&i.setRequestHeader(this.authTokenHeader,this.authToken),i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&t.response.emit(i.responseText)},this.options.formatDataFunctionIsAsync?o.then(r=>i.send(JSON.stringify(r))):i.send(o),this._render()}_getTotalProgress(e=0){if(this.options.removeAfterUpload)return e;let t=this.getNotUploadedItems().length,i=t?this.queue.length-t:this.queue.length,o=100/this.queue.length,r=e*o/100;return Math.round(i*o+r)}_getFilters(e){if(!e)return this.options?.filters||[];if(Array.isArray(e))return e;if(typeof e=="string"){let t=e.match(/[^\s,]+/g);return this.options?.filters||[].filter(i=>t?.indexOf(i.name)!==-1)}return this.options?.filters||[]}_render(){}_queueLimitFilter(){return this.options.queueLimit===void 0||this.queue.length<this.options.queueLimit}_isValidFile(e,t,i){return this._failFilterIndex=-1,t.length?t.every(o=>(typeof this._failFilterIndex=="number"&&this._failFilterIndex++,o.fn.call(this,e,i))):!0}_isSuccessCode(e){return e>=200&&e<300||e===304}_transformResponse(e){return e}_parseHeaders(e){let t={},i,o,r;return e&&e.split(`
`).map(d=>{r=d.indexOf(":"),i=d.slice(0,r).trim().toLowerCase(),o=d.slice(r+1).trim(),i&&(t[i]=t[i]?t[i]+", "+o:o)}),t}_onWhenAddingFileFailed(e,t,i){this.onWhenAddingFileFailed(e,t,i)}_onAfterAddingFile(e){this.onAfterAddingFile(e)}_onAfterAddingAll(e){this.onAfterAddingAll(e)}_onBeforeUploadItem(e){e._onBeforeUpload(),this.onBeforeUploadItem(e)}_onBuildItemForm(e,t){e._onBuildForm(t),this.onBuildItemForm(e,t)}_onProgressItem(e,t){let i=this._getTotalProgress(t);this.progress=i,e._onProgress(t),this.onProgressItem(e,t),this.onProgressAll(i),this._render()}_onSuccessItem(e,t,i,o){e._onSuccess(t,i,o),this.onSuccessItem(e,t,i,o)}_onCancelItem(e,t,i,o){e._onCancel(t,i,o),this.onCancelItem(e,t,i,o)}},ot=(()=>{class n{constructor(t){this.fileOver=new A,this.onFileDrop=new A,this.element=t}getOptions(){return this.uploader?.options}getFilters(){return""}onDrop(t){let i=this._getTransfer(t);if(!i)return;let o=this.getOptions(),r=this.getFilters();this._preventAndStop(t),o&&this.uploader?.addToQueue(i.files,o,r),this.fileOver.emit(!1),this.onFileDrop.emit(i.files)}onDragOver(t){let i=this._getTransfer(t);this._haveFiles(i.types)&&(i.dropEffect="copy",this._preventAndStop(t),this.fileOver.emit(!0))}onDragLeave(t){this.element&&t.currentTarget===this.element[0]||(this._preventAndStop(t),this.fileOver.emit(!1))}_getTransfer(t){return t.dataTransfer?t.dataTransfer:t.originalEvent.dataTransfer}_preventAndStop(t){t.preventDefault(),t.stopPropagation()}_haveFiles(t){return t?t.indexOf?t.indexOf("Files")!==-1:t.contains?t.contains("Files"):!1:!1}static{this.\u0275fac=function(i){return new(i||n)(ie(te))}}static{this.\u0275dir=ne({type:n,selectors:[["","ng2FileDrop",""]],hostBindings:function(i,o){i&1&&f("drop",function(d){return o.onDrop(d)})("dragover",function(d){return o.onDragOver(d)})("dragleave",function(d){return o.onDragLeave(d)})},inputs:{uploader:"uploader"},outputs:{fileOver:"fileOver",onFileDrop:"onFileDrop"},standalone:!1})}}return n})();var nt=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=oe({type:n})}static{this.\u0275inj=K({imports:[_e]})}}return n})();var rt=["name","size"];var mt=n=>({"nv-file-over":n}),ct=(n,e)=>e.id;function ut(n,e){n&1&&(a(0,"div",8)(1,"span",13),p(2,"Awaiting approval"),s()())}function ht(n,e){if(n&1){let t=O();a(0,"div",1),c(1,"img",7),u(2,ut,3,0,"div",8),a(3,"div",9)(4,"app-button",10),f("buttonClick",function(){let o=x(t).$implicit,r=h();return C(r.setMainPhoto(o))}),p(5,"Main"),s(),a(6,"app-button",11),f("buttonClick",function(){let o=x(t).$implicit,r=h();return C(r.deletePhoto(o.id))}),c(7,"app-icon",12),s()()()}if(n&2){let t=e.$implicit;l(),ae("not-approved",!t.isApproved),m("src",t.url,U),l(),M(t.isApproved?-1:2),l(2),m("design",t.isMain?"primary":"tertiary")("disabled",t.isMain||!t.isApproved),l(2),m("disabled",t.isMain)}}function ft(n,e){n&1&&(a(0,"th",26),p(1,"Name"),s())}function _t(n,e){if(n&1&&(a(0,"td",27),p(1),s()),n&2){let t=e.$implicit;l(),v((t.file==null?null:t.file.name)||"-")}}function gt(n,e){n&1&&(a(0,"th",26),p(1,"Size"),s())}function vt(n,e){if(n&1&&(a(0,"td",27),p(1),w(2,"number"),s()),n&2){let t=e.$implicit;l(),G(" ",k(2,1,(t.file==null?null:t.file.size)/1024/1024,".2")||"-"," MB ")}}function bt(n,e){n&1&&c(0,"tr",28)}function xt(n,e){n&1&&c(0,"tr",29)}function Ct(n,e){if(n&1&&(a(0,"div")(1,"p",30),p(2),s(),a(3,"div"),c(4,"mat-progress-bar",31),s()()),n&2){let t=h(2);l(2),G("Queue progress: ",t.uploadProgress()," %"),l(2),m("value",t.uploadProgress())}}function yt(n,e){if(n&1){let t=O();a(0,"div",6)(1,"div")(2,"h2"),p(3,"Upload queue"),s(),a(4,"p"),p(5," Queue length: "),a(6,"span",14),p(7),s()()(),a(8,"table",15),$(9,16),u(10,ft,2,0,"th",17)(11,_t,2,1,"td",18),Q(),$(12,19),u(13,gt,2,0,"th",17)(14,vt,3,4,"td",18),Q(),u(15,bt,1,0,"tr",20)(16,xt,1,0,"tr",21),s(),a(17,"div",22)(18,"app-button",23),f("click",function(){x(t);let o=h();return C(o.uploader==null?null:o.uploader.uploadAll())}),a(19,"p",24),p(20,"Upload all"),s()(),a(21,"app-button",25),f("buttonClick",function(){x(t);let o=h();return C(o.uploader==null?null:o.uploader.cancelAll())}),a(22,"p",24),p(23,"Cancel all"),s()(),a(24,"app-button",25),f("buttonClick",function(){x(t);let o=h();return C(o.uploader==null?null:o.uploader.clearQueue())}),a(25,"p",24),p(26,"Remove all"),s()()(),u(27,Ct,5,2,"div"),s()}if(n&2){let t,i=h();l(7),v(i.uploader==null||i.uploader.queue==null?null:i.uploader.queue.length),l(),m("dataSource",i.uploaderQueue),l(7),m("matHeaderRowDef",i.columns),l(),m("matRowDefColumns",i.columns),l(2),m("disabled",!(!(i.uploader==null||(t=i.uploader.getNotUploadedItems())==null)&&t.length)),l(3),m("disabled",!(i.uploader!=null&&i.uploader.isUploading)),l(3),m("disabled",!(!(i.uploader==null||i.uploader.queue==null)&&i.uploader.queue.length)),l(3),M(i.uploader!=null&&i.uploader.isUploading?27:-1)}}var V=class n{jwtService=g(be);cdr=g(me);authStatService=g(z);memberService=g(H);member=P.required();uploader;hasBaseDropZoneOver=j(!1);uploadProgress=j(0);columns=rt;API_URL=ve.API_URL;ngOnInit(){this.initializeUploader()}fileOverBase(e){this.hasBaseDropZoneOver.set(e)}deletePhoto(e){this.memberService.deletePhoto(e).pipe(S(()=>{let t=y({},this.member());t.photos=t.photos.filter(i=>i.id!==e),this.authStatService.setUserData(t)})).subscribe()}setMainPhoto(e){this.memberService.setMainPhoto(e.id).pipe(S(()=>{let t=y({},this.member());t.photoUrl=e.url,t.photos.forEach(i=>{i.isMain=!1,i.id===e.id&&(i.isMain=!0)}),this.authStatService.setUserData(t)})).subscribe()}initializeUploader(){this.uploader=new L({url:this.API_URL+"/users/add-photo",authToken:"Bearer "+this.jwtService.token,isHTML5:!0,allowedFileType:["image"],removeAfterUpload:!0,autoUpload:!1,maxFileSize:10*1024*1024}),this.uploader.onAfterAddingFile=e=>{e.withCredentials=!1,this.cdr.markForCheck()},this.uploader.onProgressItem=(e,t)=>this.uploadProgress.set(t),this.uploader.onSuccessItem=(e,t,i,o)=>{let r=JSON.parse(t),d=y({},this.member());d.photos.push(r),r.isMain&&(d.photoUrl=r.url),this.authStatService.setUserData(d)}}get uploaderQueue(){return this.uploader?.queue?[...this.uploader.queue]:[]}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=F({type:n,selectors:[["app-photo-editor"]],inputs:{member:[1,"member"]},decls:11,vars:6,consts:[[1,"grid","editor"],[1,"editor__photo"],[1,"photo-upload","margin-top-5","flex","flex--column","gap-1"],[1,"photo-upload__drop","flex","flex--column","flex--center","gap-1"],["ng2FileDrop","",1,"photo-upload__drop--card",3,"fileOver","ngClass","uploader"],["icon","upload_file",1,"secondary-color-300",3,"size"],[1,"photo-upload__table","dosis-1-400","flex","flex--column","gap-1"],["alt","photo of user",1,"editor__photo--img",3,"src"],[1,"text-center","editor__photo--aprove"],[1,"editor__photo--buttons","flex","flex--center","gap-1"],[3,"buttonClick","design","disabled"],["design","tertiary",3,"buttonClick","disabled"],["icon","delete"],[1,"text-danger"],[1,"secondary-color-300","bold"],["mat-table","",1,"mat-elevation-z8","demo-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","size"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"flex","gap-1"],["type","button",3,"click","disabled"],[1,"bold"],["type","button",3,"buttonClick","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"margin-bottom-3"],["mode","determinate",3,"value"]],template:function(t,i){t&1&&(a(0,"div",0),se(1,ht,8,7,"div",1,ct),s(),a(3,"div",2)(4,"div",3)(5,"h2"),p(6,"Add Photos"),s(),a(7,"div",4),f("fileOver",function(r){return i.fileOverBase(r)}),c(8,"app-icon",5),p(9," Drop photos here "),s()(),u(10,yt,28,8,"div",6),s()),t&2&&(l(),le(i.member().photos),l(6),m("ngClass",de(4,mt,i.hasBaseDropZoneOver()))("uploader",i.uploader),l(),m("size",3),l(2),M(!(i.uploader==null||i.uploader.queue==null)&&i.uploader.queue.length?10:-1))},dependencies:[q,ge,nt,ot,ce,fe,xe,Je,Re,Ne,$e,Le,He,Qe,Ve,je,Ge,We],styles:[".editor[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(120px,auto));justify-content:center}.editor__photo[_ngcontent-%COMP%]{width:150px;position:relative}.editor__photo--aprove[_ngcontent-%COMP%]{color:var(--secondary-color-400);font-weight:700;position:absolute;left:0;right:0;margin-left:auto;margin-right:auto;bottom:30%;text-align:center;word-wrap:break-word;white-space:normal;width:100%;padding:0 10px;box-sizing:border-box}.editor__photo--img[_ngcontent-%COMP%]{border:1px solid var(--primary-color-200);padding:8px;width:100%;background-color:var(--primary-color-500);height:auto}.photo-upload__drop--card[_ngcontent-%COMP%]{padding:32px;background-color:var(--primary-color-500);border:3px solid var(--primary-color-400);border-radius:10px}.photo-upload[_ngcontent-%COMP%]   .nv-file-over[_ngcontent-%COMP%]{border:dotted 3px var(--secondary-color-500)}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{background-color:var(--primary-color-500);border:3px solid var(--primary-color-400);border-radius:10px}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-background-color: var(--primary-color-500)}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-header-headline-color: var(--white-color)}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-row-item-outline-color: var(--secondary-color-300)}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-row-item-label-text-color: var(--white-color)}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-header-headline-weight: 700}.photo-upload[_ngcontent-%COMP%]   [mat-table][_ngcontent-%COMP%]{--mat-table-header-headline-size: 1.2rem}.not-approved[_ngcontent-%COMP%]{opacity:.2}@media (min-width: 1400px){.editor[_ngcontent-%COMP%]{justify-content:flex-start;column-gap:2.5rem}.photo-upload[_ngcontent-%COMP%]{flex-direction:row}.photo-upload__drop[_ngcontent-%COMP%]{align-self:flex-start}.photo-upload__table[_ngcontent-%COMP%]{flex:1 1 auto}}"],changeDetection:0})};function Mt(n,e){n&1&&(a(0,"div",2)(1,"p")(2,"strong"),p(3,"Information: "),s(),p(4," You have made changes. Any unsaved changes will be lost"),s()())}function St(n,e){n&1&&(a(0,"div",17)(1,"div",18),c(2,"app-field-textarea",19)(3,"app-field-textarea",20)(4,"app-field-textarea",21),a(5,"div",22),c(6,"app-field-text",23)(7,"app-field-text",24),s()()())}function Ft(n,e){if(n&1&&(a(0,"div",17),c(1,"app-photo-editor",25),s()),n&2){let t=h();l(),m("member",t)}}function wt(n,e){if(n&1){let t=O();a(0,"h1",1),p(1,"Your profile"),s(),u(2,Mt,5,0,"div",2),a(3,"form",3),f("ngSubmit",function(){x(t);let o=h();return C(o.handleSubmit())}),a(4,"div",4)(5,"div",5)(6,"mat-card",6),c(7,"img",7),a(8,"mat-card-content",8)(9,"div")(10,"p",9),p(11,"Location:"),s(),a(12,"p"),p(13),s()(),a(14,"div")(15,"p",9),p(16,"Age:"),s(),a(17,"p"),p(18),s()(),a(19,"div")(20,"p",9),p(21,"LastActive:"),s(),a(22,"p"),p(23),w(24,"timeago"),s()(),a(25,"div")(26,"p",9),p(27,"Member since:"),s(),a(28,"p"),p(29),w(30,"date"),s()()(),a(31,"mat-card-actions",10)(32,"app-button",11)(33,"p",9),p(34,"SAVE CHANGES"),s()()()()(),a(35,"div",12)(36,"div",13)(37,"mat-tab-group")(38,"mat-tab",14),u(39,St,8,0,"ng-template",15),s(),a(40,"mat-tab",16),u(41,Ft,2,1,"ng-template",15),s()()()()()()}if(n&2){let t=e,i=h();l(2),M(i.form.dirty?2:-1),l(),m("formGroup",i.form),l(4),m("src",t.photoUrl||"/user.png",U)("alt",t.knownAs),l(6),pe("",t.city,", ",t.country,""),l(5),v(t.age),l(5),v(W(24,11,t.lastActive)),l(6),v(k(30,13,t.created,"dd MMM yyyy")),l(3),m("disabled",i.form.invalid||i.form.pristine),l(6),m("label","About "+t.firstName)}}function Et(n,e){n&1&&c(0,"mat-spinner",0)}var at=class n{fb=g(Ee);memberService=g(H);authStatService=g(z);member$=this.authStatService.userData$.pipe(Y(({userData:e})=>e),S(e=>{e&&this.form.patchValue(e)}));form=this.buildForm();buildForm(){return this.fb.group({introduction:this.fb.control("",{validators:[_.required,_.maxLength(500)]}),lookingFor:this.fb.control("",{validators:[_.required,_.maxLength(500)]}),interests:this.fb.control("",{validators:[_.required,_.maxLength(500)]}),city:this.fb.control("",{validators:[_.required,_.maxLength(20)]}),country:this.fb.control("",{validators:[_.required,_.maxLength(20)]}),username:this.fb.control("")})}handleSubmit(){if(this.form.invalid)return;let e=this.form.getRawValue();this.memberService.updateMember$(e).pipe(S(()=>{let t=y(y({},this.authStatService.getUserDataValue()),e);this.authStatService.setUserData(t),this.form.markAsPristine()})).subscribe()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=F({type:n,selectors:[["app-member-edit"]],decls:3,vars:3,consts:[["diameter","50",1,"flex--justify-center-self"],[1,"text-center"],[1,"alert"],[3,"ngSubmit","formGroup"],[1,"flex","flex--column","flex--center","member-details","padding-4","gap-2","dosis-1-400"],[1,"member-details--wrapper"],["appearance","outlined",1,"member-details__card"],["mat-card-xl-image","",3,"src","alt"],[1,"grid","member-details__card--description"],[1,"bold"],[1,"flex","gap-1","flex--center"],["type","submit","design","primary",3,"disabled"],[1,"member-details__tabs"],[1,"padding-2"],[3,"label"],["matTabContent",""],["label","Edit Photos"],[1,"padding-4"],[1,"flex","flex--column","gap-1"],["formControlName","introduction","type","text","label","Description","placeholder","Enter your profile description"],["formControlName","lookingFor","type","text","label","Looking for","placeholder","Enter what you are looking for"],["formControlName","interests","type","text","label","Intrests","placeholder","Enter what you are intrested in"],[1,"flex","gap-1"],["formControlName","city","type","text","label","City","placeholder","Enter city"],["formControlName","country","type","text","label","Country","placeholder","Enter country"],[3,"member"]],template:function(t,i){if(t&1&&(u(0,wt,42,16),w(1,"async"),u(2,Et,1,0,"mat-spinner",0)),t&2){let o;M((o=W(1,1,i.member$))?0:2,o)}},dependencies:[ue,qe,Ie,Ue,Ae,ke,q,Ke,Xe,Ze,Ye,he,R,Me,B,ye,Fe,we,Pe,Te,N,Be,ze,V,tt,et],styles:[".alert[_ngcontent-%COMP%]{width:fit-content;border:2px solid var(--secondary-color-400);padding:8px;border-radius:5px}.member-details__card[_ngcontent-%COMP%]{width:300px}.member-details__card[_ngcontent-%COMP%]{--mat-card-title-text-weight: 700}.member-details__card[_ngcontent-%COMP%]{--mat-card-subtitle-text-color: var(--primary-color-200)}.member-details__card[_ngcontent-%COMP%]{--mdc-outlined-card-outline-color: var(--primary-color-200)}.member-details__card[_ngcontent-%COMP%]{--mdc-outlined-card-outline-width: 0px}.member-details__card[_ngcontent-%COMP%]{--mdc-outlined-card-container-shape: 10px}.member-details__card[_ngcontent-%COMP%]{--mdc-outlined-card-container-color: var(--primary-color-500)}.member-details__card--description[_ngcontent-%COMP%]{font-size:1.3rem}.member-details__tabs[_ngcontent-%COMP%]{max-width:100%;border-radius:10px}.member-details__tabs[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-color: var(--secondary-color-400)}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-active-hover-indicator-color: var(--secondary-color-400)}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-active-focus-indicator-color: var(--secondary-color-400)}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-inactive-ripple-color: var(--secondary-color-400)}.member-details__tabs[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-height: 4px}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-divider-color: var(--primary-color-500)}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-inactive-label-text-color: var(--primary-color-200)}.member-details__tabs[_ngcontent-%COMP%]{--mat-tab-header-label-text-weight: 600}.member-details[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:grid;gap:1rem;margin-top:16px}.member-details[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{align-self:center;margin-top:20px;border:2px solid var(--secondary-color-400);padding:5px}@media screen and (min-width: 1400px){.member-details[_ngcontent-%COMP%]{display:grid;grid-template-columns:300px 1fr}.member-details--wrapper[_ngcontent-%COMP%]{align-self:flex-start}.member-details__tabs[_ngcontent-%COMP%]{align-self:flex-start;width:800px}}"],changeDetection:0})};export{at as MemberEditComponent};
