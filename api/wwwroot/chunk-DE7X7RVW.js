import{X as s}from"./chunk-U7UGUVDU.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function l(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,o)=>{let r=o.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function p(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return l(e)}catch{return atob(e)}}function c(t,e){if(typeof t!="string")throw new n("Invalid token specified: must be a string");e||(e={});let o=e.header===!0?0:1,r=t.split(".")[o];if(typeof r!="string")throw new n(`Invalid token specified: missing part #${o+1}`);let a;try{a=p(r)}catch(i){throw new n(`Invalid token specified: invalid base64 for part #${o+1} (${i.message})`)}try{return JSON.parse(a)}catch(i){throw new n(`Invalid token specified: invalid json for part #${o+1} (${i.message})`)}}var d=class t{_token=localStorage.getItem("token");_decodedToken=null;secondInMs=1e3;get token(){return this._token}get decodedToken(){return this._decodedToken}decodeToken(){this._token&&(this._decodedToken=c(this._token))}isTokenExpired(){this.decodeToken();let e=this._decodedToken?.exp;return e?new Date(e*this.secondInMs).getTime()-Date.now()<0:!0}isTokenValid(){return this._token?!this.isTokenExpired():!1}getRolesFromToken(){if(this.isTokenValid()){let e=this._decodedToken.role;return Array.isArray(e)?e:[e]}return null}saveToken(e){this._token=e,this.decodeToken(),localStorage.setItem("token",e)}removeToken(){localStorage.removeItem("token"),this._token=null}static \u0275fac=function(o){return new(o||t)};static \u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"})};export{d as a};
